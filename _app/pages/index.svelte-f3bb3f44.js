import{M as ke,N as P,S as W,i as G,s as Q,e as D,t as U,k as N,c as E,a as I,h as A,m as j,d as T,b as k,g as V,G as b,j as ee,O as ne,P as se,Q as O,R as x,T as ie,H as L,U as B,V as ge,W as te,w as z,x as Y,y as Z,X as q,q as H,o as R,B as $,n as pe,p as ve,v as be,Y as M,Z as Te,_ as oe}from"../chunks/vendor-e309547f.js";import{c as F}from"../chunks/singletons-d1fb5791.js";import{g as ae,l as ye,a as we,s as De,c as Ee}from"../chunks/Config-d1aac259.js";import"../chunks/Defaults-2a83e164.js";F.disable_scroll_handling;const Ie=F.goto;F.invalidate;F.prefetch;F.prefetch_routes;F.before_navigate;F.after_navigate;class Ke{}function Ne(){return`https://api.atlassian.com/ex/jira/${ye().jira.cloudId}/`}async function je(){const t=ye(),n={grant_type:"refresh_token",client_id:t.jira.clientId,client_secret:t.jira.clientSecret,refresh_token:we()},i=await(await fetch("https://auth.atlassian.com/oauth/token",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}})).json();console.log(i),De(i.access_token,i.refresh_token)}async function Ve(t){const n=Ne();let e=ae();const i=ke(e);return P.fromMillis(i.exp*1e3)<P.now()&&(console.log("updated token with refresh token"),await je(),e=ae()),await(await fetch(`${n}${t}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}})).json()}async function Ce(t){return await Ve(`rest/api/3/issue/picker?query=${t}&currentJQL=`)}function re(t,n,e){const i=t.slice();return i[8]=n[e],i}function le(t,n,e){const i=t.slice();return i[11]=n[e],i}function ue(t){let n,e,i,d=t[11].keyHtml+"",h,c,f=t[11].summary+"",u,l;function o(){return t[7](t[11])}return{c(){n=D("div"),e=D("button"),i=new ne,h=N(),c=new ne,this.h()},l(s){n=E(s,"DIV",{});var a=I(n);e=E(a,"BUTTON",{class:!0});var p=I(e);i=se(p),h=j(p),c=se(p),p.forEach(T),a.forEach(T),this.h()},h(){i.a=h,c.a=null,k(e,"class","p-1 rounded-sm svelte-1gl1x03")},m(s,a){V(s,n,a),b(n,e),i.m(d,e),b(e,h),c.m(f,e),u||(l=O(e,"click",o),u=!0)},p(s,a){t=s,a&1&&d!==(d=t[11].keyHtml+"")&&i.p(d),a&1&&f!==(f=t[11].summary+"")&&c.p(f)},d(s){s&&T(n),u=!1,l()}}}function ce(t){let n,e=t[8].label+"",i,d,h,c=t[8].issues,f=[];for(let u=0;u<c.length;u+=1)f[u]=ue(le(t,c,u));return{c(){n=D("div"),i=U(e),d=N();for(let u=0;u<f.length;u+=1)f[u].c();h=N(),this.h()},l(u){n=E(u,"DIV",{class:!0});var l=I(n);i=A(l,e),d=j(l);for(let o=0;o<f.length;o+=1)f[o].l(l);h=j(l),l.forEach(T),this.h()},h(){k(n,"class","section pb-2")},m(u,l){V(u,n,l),b(n,i),b(n,d);for(let o=0;o<f.length;o+=1)f[o].m(n,null);b(n,h)},p(u,l){if(l&1&&e!==(e=u[8].label+"")&&ee(i,e),l&17){c=u[8].issues;let o;for(o=0;o<c.length;o+=1){const s=le(u,c,o);f[o]?f[o].p(s,l):(f[o]=ue(s),f[o].c(),f[o].m(n,h))}for(;o<f.length;o+=1)f[o].d(1);f.length=c.length}},d(u){u&&T(n),x(f,u)}}}function Ue(t){let n,e,i,d,h,c,f=t[0],u=[];for(let l=0;l<f.length;l+=1)u[l]=ce(re(t,f,l));return{c(){n=D("div"),e=D("input"),i=N(),d=D("div");for(let l=0;l<u.length;l+=1)u[l].c();this.h()},l(l){n=E(l,"DIV",{class:!0});var o=I(n);e=E(o,"INPUT",{type:!0,placeholder:!0,class:!0}),i=j(o),d=E(o,"DIV",{class:!0});var s=I(d);for(let a=0;a<u.length;a+=1)u[a].l(s);s.forEach(T),o.forEach(T),this.h()},h(){k(e,"type","text"),k(e,"placeholder","issue"),k(e,"class","svelte-1gl1x03"),k(d,"class","suggestions p-2 svelte-1gl1x03"),ie(d,"open",t[2]),k(n,"class","search svelte-1gl1x03")},m(l,o){V(l,n,o),b(n,e),t[6](e),b(n,i),b(n,d);for(let s=0;s<u.length;s+=1)u[s].m(d,null);h||(c=O(e,"keyup",t[3]),h=!0)},p(l,[o]){if(o&17){f=l[0];let s;for(s=0;s<f.length;s+=1){const a=re(l,f,s);u[s]?u[s].p(a,o):(u[s]=ce(a),u[s].c(),u[s].m(d,null))}for(;s<u.length;s+=1)u[s].d(1);u.length=f.length}o&4&&ie(d,"open",l[2])},i:L,o:L,d(l){l&&T(n),t[6](null),x(u,l),h=!1,c()}}}function Ae(t,n,e){let{issueKey:i}=n,d=[],h,c=!1;async function f(s){if(!s.target.value)return;const p=await Ce(s.target.value);e(0,d=p.sections),e(2,c=!0)}async function u(s,a){e(1,h.value=`${s} - ${a}`,h),e(2,c=!1),e(5,i=s)}function l(s){B[s?"unshift":"push"](()=>{h=s,e(1,h)})}const o=s=>u(s.key,s.summaryText);return t.$$set=s=>{"issueKey"in s&&e(5,i=s.issueKey)},[d,h,c,f,u,i,l,o]}class Be extends W{constructor(n){super();G(this,n,Ae,Ue,Q,{issueKey:5})}}function Oe(t){let n,e,i,d,h,c,f,u,l,o,s,a;return{c(){n=D("div"),e=D("input"),i=N(),d=D("button"),h=U("Now"),c=N(),f=D("input"),u=N(),l=D("button"),o=U("Now"),this.h()},l(p){n=E(p,"DIV",{class:!0});var r=I(n);e=E(r,"INPUT",{type:!0,class:!0}),i=j(r),d=E(r,"BUTTON",{class:!0});var _=I(d);h=A(_,"Now"),_.forEach(T),c=j(r),f=E(r,"INPUT",{type:!0,class:!0}),u=j(r),l=E(r,"BUTTON",{class:!0});var g=I(l);o=A(g,"Now"),g.forEach(T),r.forEach(T),this.h()},h(){k(e,"type","time"),k(e,"class","start"),k(d,"class","button is-primary"),k(f,"type","time"),k(f,"class","end"),k(l,"class","button is-primary"),k(n,"class","duration svelte-1o9cuq5")},m(p,r){V(p,n,r),b(n,e),t[8](e),b(n,i),b(n,d),b(d,h),b(n,c),b(n,f),t[9](f),b(n,u),b(n,l),b(l,o),s||(a=[O(e,"change",t[2]),O(d,"click",t[3]),O(f,"change",t[2]),O(l,"click",t[4])],s=!0)},p:L,i:L,o:L,d(p){p&&T(n),t[8](null),t[9](null),s=!1,ge(a)}}}function He(t,n,e){let{duration:i}=n,{startTime:d}=n,{endTime:h}=n,c,f;const u=te();function l(){e(7,h=P.fromFormat(f.value,"HH:mm")),e(6,d=P.fromFormat(c.value,"HH:mm")),e(5,i=h.diff(d)),u("change")}function o(){return P.local().toFormat("HH:mm")}function s(){e(0,c.value=o(),c)}function a(){e(1,f.value=o(),f)}function p(_){B[_?"unshift":"push"](()=>{c=_,e(0,c)})}function r(_){B[_?"unshift":"push"](()=>{f=_,e(1,f)})}return t.$$set=_=>{"duration"in _&&e(5,i=_.duration),"startTime"in _&&e(6,d=_.startTime),"endTime"in _&&e(7,h=_.endTime)},[c,f,l,s,a,i,d,h,p,r]}class Se extends W{constructor(n){super();G(this,n,He,Oe,Q,{duration:5,startTime:6,endTime:7})}}class fe{}function de(t,n,e){const i=t.slice();return i[8]=n[e].duration,i[9]=n[e].startTime,i[10]=n[e].endTime,i[11]=n,i[12]=e,i}function he(t){let n,e,i,d,h,c;function f(s){t[4](s,t[8],t[11],t[12])}function u(s){t[5](s,t[9],t[11],t[12])}function l(s){t[6](s,t[10],t[11],t[12])}let o={};return t[8]!==void 0&&(o.duration=t[8]),t[9]!==void 0&&(o.startTime=t[9]),t[10]!==void 0&&(o.endTime=t[10]),e=new Se({props:o}),B.push(()=>M(e,"duration",f)),B.push(()=>M(e,"startTime",u)),B.push(()=>M(e,"endTime",l)),e.$on("change",t[2]),{c(){n=D("div"),z(e.$$.fragment),this.h()},l(s){n=E(s,"DIV",{class:!0});var a=I(n);Y(e.$$.fragment,a),a.forEach(T),this.h()},h(){k(n,"class","mb-2")},m(s,a){V(s,n,a),Z(e,n,null),c=!0},p(s,a){t=s;const p={};!i&&a&1&&(i=!0,p.duration=t[8],q(()=>i=!1)),!d&&a&1&&(d=!0,p.startTime=t[9],q(()=>d=!1)),!h&&a&1&&(h=!0,p.endTime=t[10],q(()=>h=!1)),e.$set(p)},i(s){c||(H(e.$$.fragment,s),c=!0)},o(s){R(e.$$.fragment,s),c=!1},d(s){s&&T(n),$(e)}}}function qe(t){let n,e,i,d,h,c,f,u,l,o,s=t[0],a=[];for(let r=0;r<s.length;r+=1)a[r]=he(de(t,s,r));const p=r=>R(a[r],1,1,()=>{a[r]=null});return{c(){n=D("div"),e=U("Duration: "),i=U(t[1]),d=N();for(let r=0;r<a.length;r+=1)a[r].c();h=N(),c=D("button"),f=U("Add Duration"),this.h()},l(r){n=E(r,"DIV",{class:!0});var _=I(n);e=A(_,"Duration: "),i=A(_,t[1]),_.forEach(T),d=j(r);for(let y=0;y<a.length;y+=1)a[y].l(r);h=j(r),c=E(r,"BUTTON",{class:!0});var g=I(c);f=A(g,"Add Duration"),g.forEach(T),this.h()},h(){k(n,"class","mb-1"),k(c,"class","button is-primary mb-2 svelte-100yq62")},m(r,_){V(r,n,_),b(n,e),b(n,i),V(r,d,_);for(let g=0;g<a.length;g+=1)a[g].m(r,_);V(r,h,_),V(r,c,_),b(c,f),u=!0,l||(o=O(c,"click",t[3]),l=!0)},p(r,[_]){if((!u||_&2)&&ee(i,r[1]),_&5){s=r[0];let g;for(g=0;g<s.length;g+=1){const y=de(r,s,g);a[g]?(a[g].p(y,_),H(a[g],1)):(a[g]=he(y),a[g].c(),H(a[g],1),a[g].m(h.parentNode,h))}for(pe(),g=s.length;g<a.length;g+=1)p(g);ve()}},i(r){if(!u){for(let _=0;_<s.length;_+=1)H(a[_]);u=!0}},o(r){a=a.filter(Boolean);for(let _=0;_<a.length;_+=1)R(a[_]);u=!1},d(r){r&&T(n),r&&T(d),x(a,r),r&&T(h),r&&T(c),l=!1,o()}}}function Me(t,n,e){let{durations:i=[]}=n,d="--:--";const h=te();be(()=>{e(0,i=[new fe])});function c(){let s=Te.fromMillis(0);i.forEach(a=>{a.duration.values!=null&&a.duration.values.milliseconds!=null&&(s=s.plus(a.duration))}),e(1,d=s.toFormat("hh:mm")),h("change")}function f(){e(0,i=[...i,new fe])}function u(s,a,p,r){p[r].duration=s,e(0,i)}function l(s,a,p,r){p[r].startTime=s,e(0,i)}function o(s,a,p,r){p[r].endTime=s,e(0,i)}return t.$$set=s=>{"durations"in s&&e(0,i=s.durations)},[i,d,c,f,u,l,o]}class Re extends W{constructor(n){super();G(this,n,Me,qe,Q,{durations:0})}}function Fe(t){let n,e,i,d,h,c,f,u,l,o,s,a,p,r,_,g;function y(m){t[4](m)}let X={};t[1]!==void 0&&(X.issueKey=t[1]),c=new Be({props:X}),B.push(()=>M(c,"issueKey",y));function v(m){t[6](m)}let w={};return t[2]!==void 0&&(w.durations=t[2]),a=new Re({props:w}),B.push(()=>M(a,"durations",v)),a.$on("change",t[3]),{c(){n=D("div"),e=D("div"),i=D("div"),d=U("Ticket & description"),h=N(),z(c.$$.fragment),u=N(),l=D("textarea"),o=N(),s=D("div"),z(a.$$.fragment),this.h()},l(m){n=E(m,"DIV",{class:!0});var K=I(n);e=E(K,"DIV",{class:!0});var C=I(e);i=E(C,"DIV",{class:!0});var S=I(i);d=A(S,"Ticket & description"),S.forEach(T),h=j(C),Y(c.$$.fragment,C),u=j(C),l=E(C,"TEXTAREA",{class:!0}),I(l).forEach(T),C.forEach(T),o=j(K),s=E(K,"DIV",{class:!0});var J=I(s);Y(a.$$.fragment,J),J.forEach(T),K.forEach(T),this.h()},h(){k(i,"class","mb-1"),k(l,"class","mt-2 svelte-9u51ym"),k(e,"class","left pr-2 svelte-9u51ym"),k(s,"class","right svelte-9u51ym"),k(n,"class","task p-2 mb-2 rounded-md svelte-9u51ym")},m(m,K){V(m,n,K),b(n,e),b(e,i),b(i,d),b(e,h),Z(c,e,null),b(e,u),b(e,l),oe(l,t[0]),b(n,o),b(n,s),Z(a,s,null),r=!0,_||(g=O(l,"input",t[5]),_=!0)},p(m,[K]){const C={};!f&&K&2&&(f=!0,C.issueKey=m[1],q(()=>f=!1)),c.$set(C),K&1&&oe(l,m[0]);const S={};!p&&K&4&&(p=!0,S.durations=m[2],q(()=>p=!1)),a.$set(S)},i(m){r||(H(c.$$.fragment,m),H(a.$$.fragment,m),r=!0)},o(m){R(c.$$.fragment,m),R(a.$$.fragment,m),r=!1},d(m){m&&T(n),$(c),$(a),_=!1,g()}}}function Je(t,n,e){let{description:i=""}=n,{issueKey:d=""}=n,{durations:h=[]}=n,c=te();function f(){c("timeChange")}function u(s){d=s,e(1,d)}function l(){i=this.value,e(0,i)}function o(s){h=s,e(2,h)}return t.$$set=s=>{"description"in s&&e(0,i=s.description),"issueKey"in s&&e(1,d=s.issueKey),"durations"in s&&e(2,h=s.durations)},t.$$.update=()=>{t.$$.dirty&3&&c("textChange",{issueKey:d,description:i})},[i,d,h,f,u,l,o]}class Pe extends W{constructor(n){super();G(this,n,Je,Fe,Q,{description:0,issueKey:1,durations:2})}}function _e(t,n,e){const i=t.slice();return i[11]=n[e],i[12]=n,i[13]=e,i}function me(t){let n,e,i,d,h;function c(o){t[8](o,t[11])}function f(o){t[9](o,t[11])}function u(o){t[10](o,t[11])}let l={};return t[11].description!==void 0&&(l.description=t[11].description),t[11].issue!==void 0&&(l.issueKey=t[11].issue),t[11].durations!==void 0&&(l.durations=t[11].durations),n=new Pe({props:l}),B.push(()=>M(n,"description",c)),B.push(()=>M(n,"issueKey",f)),B.push(()=>M(n,"durations",u)),n.$on("timeChange",t[3]),n.$on("textChange",t[4]),{c(){z(n.$$.fragment)},l(o){Y(n.$$.fragment,o)},m(o,s){Z(n,o,s),h=!0},p(o,s){t=o;const a={};!e&&s&1&&(e=!0,a.description=t[11].description,q(()=>e=!1)),!i&&s&1&&(i=!0,a.issueKey=t[11].issue,q(()=>i=!1)),!d&&s&1&&(d=!0,a.durations=t[11].durations,q(()=>d=!1)),n.$set(a)},i(o){h||(H(n.$$.fragment,o),h=!0)},o(o){R(n.$$.fragment,o),h=!1},d(o){$(n,o)}}}function Le(t){let n,e,i,d,h,c,f,u,l,o,s,a,p,r,_,g=t[0],y=[];for(let v=0;v<g.length;v+=1)y[v]=me(_e(t,g,v));const X=v=>R(y[v],1,1,()=>{y[v]=null});return{c(){n=D("div"),e=D("div"),i=U("Total Duration: "),d=U(t[1]),h=N(),c=D("div"),f=D("button"),u=U("Download"),l=N();for(let v=0;v<y.length;v+=1)y[v].c();o=N(),s=D("button"),a=U("Add Task"),this.h()},l(v){n=E(v,"DIV",{class:!0});var w=I(n);e=E(w,"DIV",{class:!0});var m=I(e);i=A(m,"Total Duration: "),d=A(m,t[1]),m.forEach(T),h=j(w),c=E(w,"DIV",{class:!0});var K=I(c);f=E(K,"BUTTON",{class:!0});var C=I(f);u=A(C,"Download"),C.forEach(T),K.forEach(T),w.forEach(T),l=j(v);for(let J=0;J<y.length;J+=1)y[J].l(v);o=j(v),s=E(v,"BUTTON",{class:!0});var S=I(s);a=A(S,"Add Task"),S.forEach(T),this.h()},h(){k(e,"class","left"),k(f,"class","button is-primary mt-1"),k(c,"class","right"),k(n,"class","mb-2 header svelte-19gutxg"),k(s,"class","button is-primary mt-1 add-task svelte-19gutxg")},m(v,w){V(v,n,w),b(n,e),b(e,i),b(e,d),b(n,h),b(n,c),b(c,f),b(f,u),V(v,l,w);for(let m=0;m<y.length;m+=1)y[m].m(v,w);V(v,o,w),V(v,s,w),b(s,a),p=!0,r||(_=[O(f,"click",t[5]),O(s,"click",t[2])],r=!0)},p(v,[w]){if((!p||w&2)&&ee(d,v[1]),w&25){g=v[0];let m;for(m=0;m<g.length;m+=1){const K=_e(v,g,m);y[m]?(y[m].p(K,w),H(y[m],1)):(y[m]=me(K),y[m].c(),H(y[m],1),y[m].m(o.parentNode,o))}for(pe(),m=g.length;m<y.length;m+=1)X(m);ve()}},i(v){if(!p){for(let w=0;w<g.length;w+=1)H(y[w]);p=!0}},o(v){y=y.filter(Boolean);for(let w=0;w<y.length;w+=1)R(y[w]);p=!1},d(v){v&&T(n),v&&T(l),x(y,v),v&&T(o),v&&T(s),r=!1,ge(_)}}}function We(t,n,e){var i=document.createElement("a"),d=new Blob([t],{type:e});i.href=URL.createObjectURL(d),i.download=n,i.click()}function Ge(t,n,e){let i=[],d="--:--",h=!1,c=!1;be(()=>{Ee()?f():Ie("/upload/config"),e(7,c=!0)});function f(){e(0,i=[...i,new Ke])}function u(){let r=Te.fromMillis(0);i.forEach(_=>{_.durations.forEach(g=>{g.duration.values!=null&&g.duration.values.milliseconds!=null&&(r=r.plus(g.duration))})}),e(1,d=r.toFormat("hh:mm")),e(6,h=!0)}function l(){e(6,h=!0)}function o(){e(6,h=!1);const r=P.now().toFormat("dd-MM-yyyy");We(JSON.stringify(i),`tasks_${r}.json`,"application/json")}function s(r,_){t.$$.not_equal(_.description,r)&&(_.description=r,e(0,i))}function a(r,_){t.$$.not_equal(_.issue,r)&&(_.issue=r,e(0,i))}function p(r,_){t.$$.not_equal(_.durations,r)&&(_.durations=r,e(0,i))}return t.$$.update=()=>{t.$$.dirty&192&&c&&(console.log(h),h?window.onbeforeunload=function(){return!0}:window.onbeforeunload=null)},[i,d,f,u,l,o,h,c,s,a,p]}class Ze extends W{constructor(n){super();G(this,n,Ge,Le,Q,{})}}export{Ze as default};
